# LLM自主介入客服工作流

LLM客服应用难点：
简单标准问题：只需要LLM对检索得到的回复模版进行润色，生成回复邮件即可
复杂业务问题：包含多个步骤，需要与多个系统交互，遵循特定的业务规则

例如：退货退款问题
退货退款通常包含多个步骤，比如核实订单信息、审核退款条件、与顾客协商确认解决方案、执行退款操作等，每个步骤可能需要与不同的系统交互，并遵循特定的业务规则。
这要求模型不仅能理解语言，还要掌握业务逻辑并具备执行能力。
*执行能力需要多方面的支持，包括与多个系统的对接、对业务规则的理解、对操作流程的控制等。是一个颇为浩大的工程，并且会影响现有工作流程。*

因此，如何最大化发挥LLM效用，深度结合客服工作场景，提高客服工作效率与质量，是一个重要的难点。

本项目通过构建半自动化的客服工作流，发挥LLM的情景理解能力，在不影响原有工作流程的情况下，自主介入生成可靠的信息和推荐回复，帮助客服人员完成沟通协商的工作。并且可以随着准确度的提升，逐步实现自动化。

关键组件：

1. 工单回复等级判别器：根据顾客信息、订单信息、物流信息等数据以及邮件内容，生成工单的回复等级。判断是否可以由LLM介入生成回复

2. 邮件回复生成器（RAG）：结合工单数据、邮件内容、检索得到的回复模版，生成回复邮件

## Setup

.ENV配置

```shell
OPENAI_API_KEY = "sk-xxx"
QWEN_API_KEY = "sk-yyyy"
```

## 项目结构说明

重要代码文件:
email_service_processor.py: 服务单处理器，包括服务单数据获取、...
email_processor.py: 邮件处理器，包括邮件数据获取、llm解析邮件流程、...
script/customer_service_llm.py: llm自主介入客服工作流demo

数据类型： 存放数据模型，包括邮件、服务单
data_structure/

服务单分析：
email_service_analysis/

数据库:
database/
database.py: 数据库连接与配置
models.py: 数据库模型
crud.py: 数据库操作
test.py: 测试数据库操作

脚本文件：
script/
update_email_service_to_db.py: 更新服务单到数据库
update_email_to_db.py: 更新邮件到数据库
customer_service_llm.py: llm自主介入客服工作流demo

工具：
utils/
chat.py: 与llm交互
tools.py: 工具函数 (如：邮件正文提取、...)
